{"version":3,"sources":["webpack:///webpack/bootstrap 73c436054da4c3d24a9c","webpack:///./frontend/tactical_warfare.js","webpack:///./frontend/game.js","webpack:///./frontend/arena.js","webpack:///./frontend/ground.js","webpack:///./frontend/cursor.js","webpack:///./frontend/player.js"],"names":["createScene","canvas","document","getElementById","engine","BABYLON","Engine","scene","Scene","camera","ArcRotateCamera","Vector3","attachControl","light","HemisphericLight","intensity","window","addEventListener","resize","runRenderLoop","render","startGame","createDemoGame","SceneLoader","ImportMesh","tank1","newMeshes","tank2","clone","rotation","y","Math","PI","arena","Player1","Player2","game","Game","players","currentPlayerIdx","myPlayerIdx","receiveMovePosition","bind","receiveMoveType","initialPositionTanks","midX","floor","ground","cellCount","midZ","globalCoordinates","cellIndicesToGlobalCoordinates","tank","position","otherPlayerIdx","matrix","Matrix","RotationAxis","Axis","Y","TransformCoordinates","startListeningForMoveOptions","startListeningForPosition","startListeningForAttack","receiveAttack","type","switchPlayer","xRot","yRot","length","DEFAULT_WALL_THICKNESS","DEFAULT_CELL_SIZE","DEFAULT_CELL_COUNT","DEFAULT_WALL_HEIGHT","DEFAULT_WALL_WIDTH","Arena","cellSize","wallThickness","wallHeight","wallWidth","groundWidth","getGroundWidth","_wallMesh","Mesh","CreateBox","scaling","z","x","wallMesh","Ground","mesh","_createGroundMesh","_handleConfirmPosition","_handleListeningForPosition","CreateGround","onDoneCallback","onclick","xIndex","zIndex","indices","_getCellIndices","cursor","e","_createCursor","pickResult","pick","clientX","clientY","name","hit","pickedPoint","setDisplayPosition","removeEventListener","gridPosition","dispose","CURSOR_Y_POSITION","Cursor","size","_displayPosition","Zero","_mesh","CreatePlane","material","StandardMaterial","diffuseColor","Color3","alpha","AIMING_CAMERA_ROT_SPEED","AIMING_CAMERA_RADIUS","AIMING_CAMERA_HEIGHT","AIMING_MAX_X_ROT","AIMING_MIN_X_ROT","Player","DemoPlayer","SocketPlayer","LocalPlayer","previousMouseX","previousMouseY","handleAimingMouseDrag","handleAimingMouseDown","handleAimingMouseUp","childMeshes","getChildMeshes","_rotXMesh","_rotYMesh","i","activeCamera","cameraTarget","getAbsolutePosition","target","radius","beta","inputs","clear","previousCameraTarget","previousCameraRadius","rotationWidget","querySelector","originalRotationWidgetMouseDown","onmousedown","_positionAimingCamera","deltaX","screenX","deltaY","screenY","onmousemove","onmouseup"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 73c436054da4c3d24a9c","import {Game, createDemoGame} from \"./game.js\";\nconst createScene = function () {\n  const canvas = document.getElementById(\"render-canvas\");\n    const engine = new BABYLON.Engine(canvas, true);\n    const scene = new BABYLON.Scene(engine);\n\n    const camera = new BABYLON.ArcRotateCamera(\n      \"camera1\",\n      -1,\n      0.8,\n      15,\n      new BABYLON.Vector3(0, 0, 0),\n      scene\n    );\n    camera.attachControl(canvas);\n    const light = new BABYLON.HemisphericLight(\n      \"light1\",\n      new BABYLON.Vector3(0, 1, 0),\n      scene\n    );\n\n    light.intensity = 0.7;\n\n    window.addEventListener('resize', () => {\n      engine.resize();\n    });\n\n    engine.runRenderLoop( () => {\n      scene.render();\n    });\n    return scene;\n\n};\n\nconst startGame = function startGame(){\n  const scene = createScene();\n  window.scene = scene;\n  createDemoGame(scene);\n  //const tank_mesh = new sand_tank.Cube_001(\"tank1\",scene, \"\");\n};\ndocument.addEventListener(\"DOMContentLoaded\", startGame);\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/tactical_warfare.js","import Arena from \"./arena.js\";\nimport {Player, DemoPlayer, LocalPlayer, SocketPlayer} from \"./player.js\";\n\nexport const createDemoGame = (scene) => {\n  BABYLON.SceneLoader.ImportMesh(\n    \"tank_body\",\n    \"models/tanks/sand_tank/\",\n    \"sand_tank.babylon\",\n    scene,\n    newMeshes => {\n      const tank1 = newMeshes[0];\n      const tank2 = tank1.clone(\"tank2\");\n      tank2.rotation.y = Math.PI;\n      const arena = new Arena(scene);\n      const Player1 = new LocalPlayer(tank1, scene, arena);\n      const Player2 = new DemoPlayer(tank2);\n\n      const game = new Game(scene, [Player1, Player2], arena );\n\n      game.startGame();\n\n    });\n};\n\nexport class Game{\n  constructor(scene, players, arena ){\n    this.players = players;\n    this.currentPlayerIdx = 0;\n    this.myPlayerIdx = 0;\n    this.scene = scene;\n    this.arena = arena;\n    this.receiveMovePosition = this.receiveMovePosition.bind(this);\n    this.receiveMoveType = this.receiveMoveType.bind(this);\n    this.initialPositionTanks();\n  }\n  initialPositionTanks(){\n    const midX = Math.floor(this.arena.ground.cellCount / 2);\n    const midZ = Math.floor(this.arena.ground.cellCount /4);\n    const globalCoordinates = this.arena.ground.cellIndicesToGlobalCoordinates(\n      [midX, midZ]\n    );\n\n    this.players[this.myPlayerIdx].tank.position = globalCoordinates;\n\n    const otherPlayerIdx = this.myPlayerIdx === 0 ? 1 : 0;\n    const matrix = BABYLON.Matrix.RotationAxis(BABYLON.Axis.Y, Math.PI);\n    this.players[otherPlayerIdx].tank.position = BABYLON.Vector3.TransformCoordinates(\n      globalCoordinates, matrix\n    );\n  }\n  startGame(){\n    this.startListeningForMoveOptions();\n  }\n  startListeningForMoveOptions(){\n    this.players[this.currentPlayerIdx].startListeningForMoveOptions(this.receiveMoveType);\n  }\n  stopListeningForMoveOptions(){\n\n  }\n  startListeningForPosition(){\n    this.players[this.currentPlayerIdx].startListeningForPosition(\n      this.receiveMovePosition);\n  }\n  startListeningForAttack(){\n    this.players[this.currentPlayerIdx].startListeningForAttack(\n      this.receiveAttack);\n  }\n  receiveMoveType(type){\n    switch(type){\n      case \"position\":\n        this.startListeningForPosition();\n        break;\n      case \"attack\":\n        this.startListeningForAttack();\n        break;\n    }\n  }\n  receiveMovePosition(position){\n    this.players[this.currentPlayerIdx].tank.position = position;\n    this.switchPlayer();\n    this.startListeningForMoveOptions();\n  }\n  receiveAttack(xRot, yRot){\n\n  }\n  startListeningForTrajectory(){\n\n  }\n  stopListeningForTrajectory(){\n\n  }\n\n  switchPlayer(){\n    if(++this.currentPlayerIdx > this.players.length -1){\n      this.currentPlayerIdx = 0;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/game.js","import Ground from \"./ground.js\";\n\nconst DEFAULT_WALL_THICKNESS = 1;\nconst DEFAULT_CELL_SIZE = 1.5;\nconst DEFAULT_CELL_COUNT = 8;\nconst DEFAULT_WALL_HEIGHT = 3;\nconst DEFAULT_WALL_WIDTH = 0.6;\n\nexport default class Arena{\n  constructor(scene, cellSize =DEFAULT_CELL_SIZE, cellCount=DEFAULT_CELL_COUNT,\n     wallThickness=DEFAULT_WALL_THICKNESS, wallHeight = DEFAULT_WALL_HEIGHT,\n      wallWidth = DEFAULT_WALL_WIDTH){\n    this.ground = new Ground(scene, cellSize, cellCount, wallThickness);\n    const groundWidth = this.ground.getGroundWidth();\n    this._wallMesh = new BABYLON.Mesh.CreateBox(\"centerWall\",\n      groundWidth, scene);\n    this._wallMesh.scaling.z = wallThickness / groundWidth;\n    this._wallMesh.scaling.y = wallHeight/ groundWidth;\n    this._wallMesh.scaling.x = wallWidth;\n    this._wallMesh.position.y += wallHeight /2;\n    window.wallMesh = this._wallMesh;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/arena.js","import Cursor from \"./cursor.js\";\nexport default class Ground{\n  constructor(scene,\n              cellSize,\n              cellCount,\n              wallThickness){\n    this.scene = scene;\n    this.cellSize = cellSize;\n    this.cellCount = cellCount;\n    this.wallThickness = wallThickness;\n    this.mesh = this._createGroundMesh();\n    this._handleConfirmPosition = this._handleConfirmPosition.bind(this);\n    this._handleListeningForPosition = this._handleListeningForPosition.bind(this);\n  }\n  _createGroundMesh(){\n    return BABYLON.Mesh.CreateGround(\"ground\", this.cellSize*\n    this.cellCount,\n    this.cellSize*this.cellCount+ this.wallThickness,\n    2, this.scene);\n  }\n  startListeningForPosition(onDoneCallback){\n    document.getElementById('render-canvas').addEventListener(\"mousemove\",\n      this._handleListeningForPosition);\n    document.getElementById(\"render-canvas\").onclick =\n      this._handleConfirmPosition(onDoneCallback);\n  }\n  _getCellIndices(globalCoordinates){\n    const xIndex = Math.floor(\n      (globalCoordinates.x +\n        (this.cellCount * this.cellSize/2)\n      ) / this.cellSize\n    );\n\n    let zIndex =  Math.floor(\n      (globalCoordinates.z + this.wallThickness /2\n\n      ) / this.cellSize * -1\n    );\n    return [xIndex, zIndex];\n\n  }\n  cellIndicesToGlobalCoordinates(indices){\n    let x = indices[0] * this.cellSize + this.cellSize/2 - this.getGroundWidth()/2;\n    let z = -1 * (indices[1] * this.cellSize + this.cellSize/2 + this.wallThickness/2);\n    return new BABYLON.Vector3(x, 0, z);\n  }\n  getGroundWidth(){\n    return this.cellSize * this.cellCount;\n  }\n  _getCellCenteredCoordinates(globalCoordinates){\n    let indices = this._getCellIndices(globalCoordinates);\n    return this.cellIndicesToGlobalCoordinates(indices);\n  }\n  _createCursor(){\n    this.cursor = new Cursor(this.scene, this.cellSize);\n  }\n  _handleListeningForPosition(e){\n    if(!this.cursor){\n      this._createCursor();\n    }\n    const pickResult = this.scene.pick(e.clientX, e.clientY, mesh => {\n      return this.mesh.name ===mesh.name;\n    });\n    if(pickResult.hit){\n      const indices = this._getCellIndices(pickResult.pickedPoint);\n      if (indices[1] >= 0){\n        this.cursor.setDisplayPosition(this.cellIndicesToGlobalCoordinates(\n          indices\n        ));\n      }\n    }\n  }\n  _handleConfirmPosition(onDoneCallback){\n    return e=>{\n      const pickResult = this.scene.pick(e.clientX, e.clientY, mesh => {\n        return this.mesh.name ===mesh.name;\n      });\n      if(pickResult.hit){\n        const indices = this._getCellIndices(pickResult.pickedPoint);\n        if (indices[1] >= 0){\n          this.cursor.setDisplayPosition(\n            this.cellIndicesToGlobalCoordinates(indices)\n          );\n          document.getElementById('render-canvas').removeEventListener(\"mousemove\",\n            this._handleListeningForPosition);\n          document.getElementById('render-canvas').onclick = null;\n          const gridPosition = this.cursor.gridPosition();\n          this.cursor.dispose();\n          this.cursor = null;\n          onDoneCallback(gridPosition);\n        }\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/ground.js","const CURSOR_Y_POSITION = 0.02;\n\n\nexport default class Cursor{\n  constructor(scene, size){\n    this._displayPosition = new BABYLON.Vector3.Zero();\n    this._mesh = new BABYLON.Mesh.CreatePlane(\"cursor\", size, scene);\n    this._mesh.material = new BABYLON.StandardMaterial(\"mat1\", scene);\n    this._mesh.material.diffuseColor = new BABYLON.Color3(0.5, 0, 0);\n    this._mesh.material.alpha = 0.9;\n    this._mesh.rotation.x = Math.PI/2\n  }\n  setDisplayPosition(globalCoordinates){\n    this._mesh.position = globalCoordinates;\n    this._mesh.position.y = CURSOR_Y_POSITION;\n  }\n  gridPosition(){\n    const gridPosition = this._mesh.position.clone();\n    gridPosition.y = 0;\n    return gridPosition;\n  }\n  dispose(){\n    this._mesh.dispose();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/cursor.js","const AIMING_CAMERA_ROT_SPEED = 0.05;\nconst AIMING_CAMERA_RADIUS = 2;\nconst AIMING_CAMERA_HEIGHT = 1;\n\nconst AIMING_MAX_X_ROT = 0.9;\nconst AIMING_MIN_X_ROT = - 0.5;\n\nexport class Player{\n  constructor(tank){\n    this.tank = tank;\n  }\n  startListeningForMoveOptions(onDoneCallback){\n    onDoneCallback(\"attack\");\n  }\n  startListeningForAttack(onDoneCallback){\n    onDoneCallback(0,0);\n  }\n}\n\nexport class DemoPlayer extends Player{\n  constructor(tank){\n    super(tank);\n  }\n  startListeningForPosition(onDoneCallback){\n    onDoneCallback(this.tank.position);\n  }\n};\n\nexport class SocketPlayer extends Player{\n  constructor(tank){\n    super(tank);\n  }\n  startListeningForPosition(onDoneCallback){\n    //socket.on\n  }\n}\n\nexport class LocalPlayer extends Player{\n  constructor(tank, scene, arena){\n    super(tank);\n    this.arena = arena;\n    this.scene = scene;\n    this.previousMouseX = null;\n    this.previousMouseY = null;\n    this.handleAimingMouseDrag = this.handleAimingMouseDrag.bind(this);\n    this.handleAimingMouseDown = this.handleAimingMouseDown.bind(this);\n    this.handleAimingMouseUp = this.handleAimingMouseUp.bind(this);\n\n    const childMeshes = this.tank.getChildMeshes();\n    this._rotXMesh = null;\n    this._rotYMesh = null;\n    for(let i = 0; i < childMeshes.length; ++i){\n      if(childMeshes[i].name === \"tank_rot_x\"){\n        this._rotXMesh = childMeshes[i];\n      }\n      else if (childMeshes[i].name === \"tank_rot_y\"){\n        this._rotYMesh = childMeshes[i];\n      }\n    }\n  }\n  startListeningForPosition(onDoneCallback){\n\n    this.arena.ground.startListeningForPosition(onDoneCallback);\n    //socket.emit\n  }\n  _positionAimingCamera(){\n    const camera = this.scene.activeCamera;\n    const cameraTarget = this._rotXMesh.getAbsolutePosition().clone();\n    cameraTarget.y += AIMING_CAMERA_HEIGHT;\n    camera.target = cameraTarget;\n    camera.radius = AIMING_CAMERA_RADIUS;\n    camera.alpha = -1 *this._rotYMesh.rotation.y + Math.PI/2;\n    camera.beta = this._rotXMesh.rotation.x + Math.PI/2;\n  }\n  startListeningForAttack(onDoneCallback){\n    this.scene.activeCamera.inputs.clear();\n    const camera = this.scene.activeCamera;\n\n    this.previousCameraTarget = camera.target;\n    this.previousCameraRadius = camera.radius;\n    camera.radius = AIMING_CAMERA_RADIUS;\n    const canvas = document.getElementById(\"render-canvas\");\n    const rotationWidget = document.querySelector(\".camera-rotation\");\n    this.originalRotationWidgetMouseDown = rotationWidget.onmousedown;\n    rotationWidget.onmousedown  = this.handleAimingMouseDown;\n    this._positionAimingCamera();\n  }\n  stopListeningForAttack(){\n    const rotationWidget = document.querySelector(\".camera-rotation\");\n    rotationWidget.onmousedown   = this.originalRotationWidgetMouseDown;\n  }\n  handleAimingMouseDrag(e){\n    const deltaX = e.screenX - this.previousMouseX;\n    const deltaY = e.screenY - this.previousMouseY;\n    this._rotYMesh.rotation.y += deltaX * AIMING_CAMERA_ROT_SPEED;\n    this._rotXMesh.rotation.x -= deltaY * AIMING_CAMERA_ROT_SPEED;\n    this.previousMouseX = e.screenX;\n    this.previousMouseY = e.screenY;\n    if(this._rotXMesh.rotation.x > AIMING_MAX_X_ROT){\n      this._rotXMesh.rotation.x = AIMING_MAX_X_ROT;\n    }\n    if(this._rotXMesh.rotation.x < AIMING_MIN_X_ROT){\n      this._rotXMesh.rotation.x = AIMING_MIN_X_ROT;\n    }\n    this._positionAimingCamera();\n  }\n  handleAimingMouseDown(e){\n    this.previousMouseX = e.screenX;\n    this.previousMouseY = e.screenY;\n    window.onmousemove = this.handleAimingMouseDrag;\n    window.onmouseup = this.handleAimingMouseUp;\n  }\n  handleAimingMouseUp(e){\n    window.onmousemove = null;\n    window.onmouseup = null;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/player.js"],"sourceRoot":""}